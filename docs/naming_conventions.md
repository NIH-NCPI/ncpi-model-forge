
# Naming Conventions in NCPI Project Forge FHIR Data Model

This document describes the naming conventions for ids and
the file names for resources in the NCPI Project Forge FHIR data model.

## Resource Id

### Semantics

The `id` attribute for a resource in the FHIR model should be
populated with some kind of logical value that describes the semantics of
the resource (e.g. `ResearchParticipant` vs `2349703`).

**NOTE:** This ONLY applies to the files in the FHIR model. Non-conformance
resources (representing real data) loaded into the FHIR server will likely
have an autogenerated alphanumeric ID which may or may not be random.

### Syntax

The `id` value should conform to the regex pattern in the
[FHIR spec](https://www.hl7.org/fhir/datatypes.html#id).

### Casing

All resource `id` values should have the same casing. There does not seem
to be a consistent standard or recommendation for this, but we should pick
one and stick to it.

Based on observations, the FHIR spec seems to use PascalCase for
resource types (e.g. `Patient`, `SearchParameter`) and camelCase
(e.g. `gender`, `birthDate`) for resource attributes.

The NCPI Project Forge resource `id` values will be lowercased with hyphens between
words (e.g. `age-at-event`, `sequencing-experiment`).  


## Resource File Name

All resource file names should follow the pattern expected by the IG Publisher:

**Pattern**
```
<resource type>-<resource id>.json
```

### File Name Delimiter

The file name delimiter will be a hyphen `-`.

**Example StructureDefinition Resource**
```json
{
  "resourceType": "StructureDefinition",
  "id": "participant",
  "url": "https://fhir.ncpi-project-forge.io/StructureDefinition/participant",
  "name": "participant",
  "status": "draft",
  "fhirVersion": "4.0.0",
  "kind": "resource",
  "abstract": false,
  "type": "Patient",
  "baseDefinition": "https://hl7.org/fhir/StructureDefinition/Patient",
  "derivation": "constraint",
  "differential": {
    "element": [
      {
        "id": "Patient.gender",
        "path": "Patient.gender",
        "min": 1
      },
      {
        "id": "Patient.birthDate",
        "path": "Patient.birthDate",
        "max": "0"
      }
    ]
  }
}
```

**File Name Example**
```
StructureDefinition-participant.json
```

**Example Patient**
```json
{
    "resourceType":"Patient",
    "id": "pt-001",
    "meta": {
        "profile": [
            "https://fhir.ncpi-project-forge.io/StructureDefinition/participant"
        ]
    },
    "gender": "female",
    "name": [
        {
            "family":"Smith"
        }
    ]
}
```

**File Name Example**
```
Patient-pt-001.json
```

## Specific Rules for StructureDefinitions

The following rules apply to non-Extension type `StructureDefinitions` and
are intended to help NCPI Project Forge separate the constraints for
Protected Health Information (PHI) from the constraints in base NCPI Project Forge
profiles.

All `StructureDefinition.id` values will be split into two tokens. The first
token will be the prefix, `ncpi-`, and the second token will be the name of
the profile.

If a StructureDefinition does not change the underlying meaning of the
FHIR base type it is profiling, then the `id` of the FHIR base resource will be
used as the second token.

- **Example 1**: the NCPI Project Forge condition profile will have an
  id = `ncpi-condition` because it is simply extending `Condition` by adding
  the `age-at-event` extension
- **Example 2**: the NCPI Project Forge phenotype profile will have an
  id = `ncpi-phenotype` because it is representing a specific kind of
  observation.


## Other Things to Keep in Mind

### SearchParameter Generation

We will autogenerate search parameters off of our extensions. The `id`
will be used as the `SearchParameter.code` (the term used in the
query part of the URL).

Example:
```
/Observation?_profile=<Phenotype url>&age-at-event=10
```
